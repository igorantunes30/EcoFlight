import socket

# Caminho da imagem armazenada no Raspberry Pi
IMAGE_PATH = '/home/lprad/EcoFlight/oip_comp.jpg'

# IP e porta do ESP32
ESP32_IP = '192.168.4.1'  # IP do ESP32 no modo Access Point
ESP32_PORT = 80

# Função para ler e enviar a imagem armazenada
def send_image():
    # Abre o arquivo da imagem armazenada
    with open(IMAGE_PATH, 'rb') as image_file:
        # Conectando ao ESP32
        client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        client_socket.connect((ESP32_IP, ESP32_PORT))
        
        # Envia a imagem em pacotes de 1024 bytes
        while True:
            chunk = image_file.read(1024)  # Lê 1024 bytes por vez
            if not chunk:
                break  # Sai do loop se não houver mais dados
            client_socket.send(chunk)

        # Finaliza a transmissão
        client_socket.close()
        print("Imagem enviada com sucesso!")

# Envia a imagem apenas uma vez
send_image()
