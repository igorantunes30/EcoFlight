#include <WiFi.h>
#include <WiFiClient.h>
#include <WiFiServer.h>

const char* ssid = "esp32_A";  // Nome da rede Wi-Fi (SSID)
const char* password = "12345678";  // Senha da rede Wi-Fi

WiFiServer server(80);  // Inicia o servidor na porta 80 (HTTP)

void setup() {
  Serial.begin(115200);
  
  // Configura o ESP32 como Access Point
  WiFi.softAP(ssid, password);
  Serial.println("Ponto de Acesso iniciado");
  Serial.print("Endereço IP: ");
  Serial.println(WiFi.softAPIP());

  // Inicia o servidor
  server.begin();
  Serial.println("Servidor iniciado");
}

void loop() {
  WiFiClient client = server.available();
  
  if (client) {
    Serial.println("Cliente conectado, recebendo imagem...");
    uint8_t buffer[1024];
    
    while (client.connected()) {
      // Lê os dados da imagem em pacotes de 1024 bytes
      int bytesRead = client.read(buffer, sizeof(buffer));
      if (bytesRead > 0) {
        // Aqui você pode processar a imagem
        Serial.print("Recebido: ");
        Serial.print(bytesRead);
        Serial.println(" bytes");
        
        // Exemplo: você pode salvar ou exibir os dados de alguma forma
        // Por enquanto, apenas exibe os dados no monitor serial
        for (int i = 0; i < bytesRead; i++) {
          Serial.print(buffer[i], HEX);
          Serial.print(" ");
        }
        Serial.println();
      }
    }
    client.stop();
    Serial.println("Cliente desconectado");
  }
}
