from picamera2 import Picamera2, Preview
from time import sleep

def check_camera():
    try:
        # Inicializa a câmera
        picam2 = Picamera2()

        # Configuração de captura de vídeo com resolução padrão (1280x720)
        config = picam2.create_video_configuration(main={"size": (1280, 720)})
        picam2.configure(config)

        # Exibe o vídeo em tempo real usando o Preview nativo
        picam2.start_preview(Preview.QTGL)

        # Inicia a captura do vídeo (somente para exibição)
        picam2.start()

        print("Capturando vídeo em tempo real. Pressione Ctrl+C para parar.")

        # Mantém o vídeo em exibição até a interrupção com Ctrl+C
        while True:
            sleep(1)  # Mantém o loop ativo enquanto o vídeo é exibido

    except KeyboardInterrupt:
        # Para a câmera quando o programa é interrompido
        print("Parando a captura de vídeo.")
        picam2.stop_preview()
        picam2.stop()

    except Exception as e:
        print(f"Erro ao acessar a câmera: {e}")

if __name__ == "__main__":
    check_camera()
